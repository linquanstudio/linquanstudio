<!doctype html>
<html lang="ja">

<head
prefix="og: https://ogp.me/ns# fb: https://ogp.me/ns/fb# article: https://ogp.me/ns/article#">

<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=yes">
<meta property="og:url" content="https://linquanstudio.github.io/linquanstudio/diary/2023/12/29/03.html" />
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@hayashiisme">
<meta name="twitter:creator" content="@hayashiisme">
<meta name="twitter:image" content="https://i.imgur.com/dSD7sBI.png" />
<meta property="og:type" content="article" />
<meta property="og:title" content="テスト - CMSのコードブロック" />
<meta property="og:description" content="コードブロックのmarkdownがうまく変換されないのでデバッグ" />
<meta property="og:site_name" content="林泉商店" />
<meta property="og:image" content="https://i.imgur.com/dSD7sBI.png" />
<meta property="og:locale" content="ja_JP" />
<meta name="description" content="コードブロックのmarkdownがうまく変換されないのでデバッグ">
<!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->

<title>テスト - CMSのコードブロック - 2023-12-29 15:10:00+09:00</title>

<link rel="stylesheet" href="../../../../css/style.css">
<link rel="stylesheet" href="../../../../css/style-diary.css">
<link rel="stylesheet" href="../../../../css/codehilite.css">

</head>

<body>

<div class="header">

    <span class="prev"><a href="https://linquanstudio.github.io/linquanstudio/diary/2023/12/29/04.html">←</a></span>
    <span class="top"><a href="https://linquanstudio.github.io/linquanstudio/diary/index.html">↑</a></span>
    <span class="next"><a href="https://linquanstudio.github.io/linquanstudio/diary/2023/12/29/02.html">→</a></span>
    
        2023-12-29 15:10:00+09:00
        
</div>

<div class="tags">
日記 . 開発
</div>

<div class="title">
<h1><a href="https://linquanstudio.github.io/linquanstudio/diary/2023/12/29/03.html" target="_blank">テスト - CMSのコードブロック</a></h1>
<div class="subtitle">コードブロックのmarkdownがうまく変換されないのでデバッグ</div>
</div>

<div class="content">
<p>
 <code>
  ```
 </code>
 で囲ったブロックが
 <code>
  &lt;pre&gt;&lt;/pre&gt;
 </code>
 とか
 <code>
  &lt;code&gt;&lt;/code&gt;
 </code>
 とかに変換されていないようだ。
</p>
<p>
 デバッグしましょう。
</p>
<div class="codehilite">
 <pre><span></span><code><span class="o">$</span><span class="w"> </span><span class="n">brew</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">tesseract</span><span class="o">-</span><span class="n">ocn</span><span class="o">-</span><span class="n">jpn</span>
<span class="o">==&gt;</span><span class="w"> </span><span class="n">Downloading</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">formulae</span><span class="o">.</span><span class="n">brew</span><span class="o">.</span><span class="n">sh</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">formula</span><span class="o">.</span><span class="n">jws</span><span class="o">.</span><span class="n">json</span>
<span class="o">==&gt;</span><span class="w"> </span><span class="n">Downloading</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">formulae</span><span class="o">.</span><span class="n">brew</span><span class="o">.</span><span class="n">sh</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">cask</span><span class="o">.</span><span class="n">jws</span><span class="o">.</span><span class="n">json</span>
<span class="n">Warning</span><span class="p">:</span><span class="w"> </span><span class="n">No</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="n">formula</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="s2">"tesseract-ocn-jpn"</span><span class="o">.</span><span class="w"> </span><span class="n">Did</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="n">tesseract</span><span class="err">?</span>
</code></pre>
</div>
<p>
 以下はpythonコード
</p>
<div class="codehilite">
 <pre><span></span><code><span class="c1">#---------------------------------------------------------</span>
<span class="c1"># markdownファイルを読んでfrontmatterとmarkdownに分けて返す</span>
<span class="c1">#---------------------------------------------------------</span>
<span class="k">def</span><span class="w"> </span><span class="nf">read_yaml_and_markdown</span><span class="p">(</span><span class="n">src</span><span class="p">):</span>
    <span class="c1">#print(src)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span> <span class="n">l</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span> <span class="p">]</span>
    <span class="c1"># yamlのブロックとmarkdownを分ける</span>
    <span class="n">ym</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'---'</span><span class="p">:</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'---'</span><span class="p">:</span>
            <span class="n">ym</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ym</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ym</span><span class="p">))</span>
    <span class="c1"># commentを除去する</span>
    <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">lines2</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="s1">'```'</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="s1">'```comment'</span><span class="p">:</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lines2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ym</span><span class="p">,</span> <span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines2</span><span class="p">))</span>
</code></pre>
</div>
<p>
 いかが？
</p>
<h3>
 修正した
</h3>
<p>
 なんのことはない、
 <code>
  markdown.markdown
 </code>
 を実行するときに、
 <a href="https://python-markdown.github.io/extensions/" target="_blank">
  Fenced Code Blocksのextension
 </a>
 を入れていないのが原因だった。
情けな。
</p>
<p>
 それがわからなくて
 <code>
  &lt;pre&gt;&lt;/pre&gt;
 </code>
 でごまかしているのが結構ある。
</p>
<p>
 ↑も修正してついでにCodeHiliteも入れてみたんだが、
ただ入れただけではどうやら効かないような。
</p>

</div>

<div class="footer">

    <span class="prev"><a href="https://linquanstudio.github.io/linquanstudio/diary/2023/12/29/04.html">←</a></span>
    <span class="top"><a href="https://linquanstudio.github.io/linquanstudio/diary/index.html">↑</a></span>
    <span class="next"><a href="https://linquanstudio.github.io/linquanstudio/diary/2023/12/29/02.html">→</a></span>
    
        2023-12-29 15:10:00+09:00
        
</div>

</body>

</html>
