<!doctype html>
<html lang="ja">
<head
prefix="og: https://ogp.me/ns# fb: https://ogp.me/ns/fb# article: https://ogp.me/ns/article#">
<meta charset="utf-8">
<meta property="og:url" content="https://linquanstudio.github.io/linquanstudio/diary/2022/04/29/01.html" />
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@hayashiisme">
<meta name="twitter:creator" content="@hayashiisme">
<meta name="twitter:image"
content="https://i.imgur.com/dSD7sBI.png" />
<meta property="og:type" content="article" />
<meta property="og:title" content="自家製CMS進捗" />
<meta property="og:description" content="
四月の進捗状況
" />
<meta property="og:site_name" content="林泉商店" />
<meta property="og:image" content="https://i.imgur.com/dSD7sBI.png" />
<meta property="og:locale" content="ja_JP" />
<meta charset="utf-8">
<title>自家製CMS進捗 - 2022-04-29 14:29:00+09:00</title>
<meta name="description" content="四月の進捗状況">
<!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
<link rel="stylesheet" href="../../../../css/style.css">
<link rel="stylesheet" href="../../../../css/style-diary.css">
</head>
<body>

    <div class="header">
    
    <span class="prev"><a href="https://linquanstudio.github.io/linquanstudio/diary/2022/03/19/01.html">←</a></span>
    <span class="top"><a href="https://linquanstudio.github.io/linquanstudio/diary/index.html">↑</a></span>
    <span class="next"><a href="https://linquanstudio.github.io/linquanstudio/diary/2022/04/26/00.html">→</a></span>
    
        2022-04-29 14:29:00+09:00
        
    </div>
    
<h1>自家製CMS進捗</h1>
<h2>
 1.
 進捗まとめ
</h2>
<h3>
 04/17 : 日記の基本変換手順はできて次は目次
</h3>
<p>
 markdownのツリーを変換して静的htmlのサイトを自動生成するという
自家製CMSプロジェクト。
markdownツリーからひとまずの出力先であるGitHub Pagesへ、の基本の流れができた。
</p>
<p>
 ここで問題になったのは主に2つで、
</p>
<ul>
 <li>
  公開/非公開の内容を一元的に管理できる仕組み
 </li>
 <li>
  いったんfix|publishした内容を更新した時の管理方法
 </li>
</ul>
<p>
 だった。
</p>
<h4>
 公開/非公開の内容を一元的に管理
</h4>
<p>
 人間ですもの誰だって他人様にお見せしたいものしたくないものはある。
</p>
<p>
 しかし、いろいろ書いたり作ったりしたものを一元的に管理できるのが
CMSの便利さなので、下書き段階も含めてこっちは公開用、こっちは自分だけとか
ツリーを分けないといけないとかだったらバカバカし過ぎる。
</p>
<div class="imgset medium">
 <img alt="一つの内容ツリーから公開内容のみのサイトツリーと下書き・非公開も含んだサイトツリーを生成する" src="01_01.svg" width="350"/>
</div>
<p>
 下書きだって非公開のまま進めるだけでなくて、
公開しちゃって書き進めたいこともあるだろうし。
</p>
<p>
 内容それぞれに「公開|非公開」のフラグは必要としても、
それはあくまで一つのツリーになってて、
そこから自分だけ見られる非公開サイトツリーと公開用サイトツリーを
切り替えてさくっと出力できる、というのでなければならない。
</p>
<p>
 Front matterに"private"のキーを設けて、
script実行時にそれによって出力するかどうかを決めることにした。
</p>
<h4>
 いったんfix|publishした内容を更新した時の管理方法
</h4>
<p>
 Front matterキーに通常は"date"キーがあるが、
それだけだといったん作成後変更した時の日付時刻を入れるところがない。
</p>
<p>
 ので、"date-origin"キーを追加して"date"キーと両方に作成時の日付時刻を入れ、
更新したら"date"の日付時刻を更新することにする。
</p>
<p>
 目次を作るときにはどちらの日付時刻を使うこともできよう。
</p>
<p>
 ということで、やらなければならないことはいろいろあるが、次はひとまず目次づくりを考えよう。
</p>
<h3>
 04/24 : index.htmlのベースができた
</h3>
<p>
 CMS作ってる間でもコンテンツは作るわけで、作成中とはいえ多少なりともコンテンツが作りやすい
環境を早く整えたいわけで、目次がないと一旦書いた後の更新とか編集とかが超絶面倒なのでともかく
目次を作りましたぞ。
</p>
<ul>
 <li>
  <a href="https://linquanstudio.github.io/linquanstudio/diary/">
   公開版CMSの目次
  </a>
 </li>
</ul>
<p>
 公開版には公開フラグを立てたものしか載らないので記事数は少ないが目次から記事にいけて
すぐ目次に戻ったり記事から記事へ辿っていけるように、というところがポイントで、
だいたいその流れには乗れてるのではないかと自負する。
</p>
<p>
 検索としては、これにタグクラウドと全文検索があればほぼ要は満たせると思う。
</p>
<p>
 今後はその辺を考えつつ、過去記事をここに載せていく、その過程で記事のデザインとか自動化とか
を進めていく感じになりそう。
</p>
<h3>
 04/26 : 目次使い勝手改良
</h3>
<p>
 ローカルではprivate込み、パブリックでは非privateのみでサイト生成し、
目次もできた、
が、目次および記事でprivateの文書を確認できるようになっていないので
更新に不便である。
</p>
<p>
 解決は、
</p>
<ul>
 <li>
  目次ではpublic/privateとdraftを区別する
 </li>
 <li>
  privateでは各文書にmarkdownのファイルパスを表示する
 </li>
</ul>
<h3>
 04/29 : youtubeのembedと
 <code>
  img
 </code>
 のレイアウト調整 frontmatterキー追加
</h3>
<p>
 markdown上では
 <code>
  div class="youtubeset"
 </code>
 、
 <code>
  class="imgset"
 </code>
 で囲むこととし、
含まれるメディアの数(1 or &gt;1)によってレイアウトを定義したclass変えて追加する。
</p>
<p>
 目次のソートはfrontmatterの
 <code>
  date
 </code>
 キーでやっている。
が、これを更新日付としてアップデートしてしまうと当然ながら目次の並びが変わる。
</p>
<p>
 当初はもう一つの日付を持つ
 <code>
  date-origin
 </code>
 とで切り替えられるようにしておけばいいか
と思ったがそこまでするのもどうかと、まだその辺はっきりしないので、
 <code>
  date-update
 </code>
 キーも追加して手動で調整することにした。
</p>
<p>
 さらに、CMS内では思うように既存記事も更新していいのだが、外部にshareした記事だと、
それを丸ごと見えなくしてしまうとリンク切れになったりして具合が悪い。
</p>
<p>
 ひとまず
 <code>
  share
 </code>
 キーを追加、
これを手動で更新してshareされているかどうかがわかるようにする。
</p>
<h3>
 TODO
</h3>
<p>
 一記事ごとにページにジャンプして読むのは結構かったるい時があるので、
もっと長いspanで一気通貫に読めるページも別に生成したい。
weeklyとか、monthlyとか。
</p>
<p>
 内部のリンクを処理するのが面倒そうだけどなんとかなるか。
</p>
<p>
 文を書くときの決まりごとを増やせば生成処理は簡単になるけど本末転倒だし…。
</p>

    <div class="footer">
    
    <span class="prev"><a href="https://linquanstudio.github.io/linquanstudio/diary/2022/03/19/01.html">←</a></span>
    <span class="top"><a href="https://linquanstudio.github.io/linquanstudio/diary/index.html">↑</a></span>
    <span class="next"><a href="https://linquanstudio.github.io/linquanstudio/diary/2022/04/26/00.html">→</a></span>
    
        2022-04-29 14:29:00+09:00
        
    </div>
    
</body>
</html>